% % % % 
% % % tmin = .1;
% % % tmax = 6.5;
% % % dim = 3;
% % % jump = 1;
% % % initial = 1;
% % % N_tau = 100;
% % % mesh = 100;
% % % 
% % % X = zeros([mesh 1]);
% % % 
% % % Z= zeros([mesh 1]);
% % % 
% % % 
% % %  vec = [1.595, 1.8913000000000004, 1.9666999999999992, 2.00492000000000004, 2.0003999999999995, 1.9939000000000002, 2.0317999999999996, 1.9878, 2.0046999999999997, 2.0003, 2.0064999999999995, 2.0077000000000003, 1.9898, 1.9945000000000002, 2.0073, 2.007, 1.9913999999999998, 1.9994999999999998, 1.9963999999999997, 1.9989, 1.9971999999999999, 1.9856999999999998, 2.0011, 1.9915999999999998, 1.99, 2.006, 1.9957999999999998, 2.010300000000001, 1.9999999999999996, 1.85, 1.7345, 1.045, 0.9992, 1.3781999999999999, 1.8909999999999998, 1.9476, 2.0066999999999995, 1.9975000000000003, 2.0265, 2.0079, 1.992, 2.0065, 2.0082, 1.9964, 2.0048999999999997, 1.9968, 2.0003, 1.999, 2.0004, 2.0094999999999996, 1.9986000000000002, 2.0001, 1.9999, 1.9851999999999999, 2.0090000000000003, 1.9964, 2.0032000000000005, 2.0039, 2.0173, 1.9951, 2.0030999999999995, 1.9723999999999993, 1.9481000000000002, 1.4444000000000001, 1.0125, 1.0755, 1.5013999999999994, 1.9768000000000001, 1.9973000000000005, 2.0023999999999997, 2.0175, 2.0022, 2.0093000000000005, 1.9793, 1.9954999999999998, 2.0188000000000006, 2.0058000000000002, 2.003, 1.9959999999999998, 1.9990000000000003, 2.002, 2.0054, 2.0026999999999995, 2.0018000000000002, 1.9930999999999999, 2.0111, 1.9984999999999997, 1.9896, 2.0165, 2.008, 2.00436, 2.0262000000000002, 1.9976000000000002, 1.9732999999999998, 1.9627000000000006, 1.8366, 1.2778, 0.9995, 1.0842000000000007, 1.7320999999999993];
% % % 
% % %     for i= 1:mesh
% % %         X(i) = (tmax-tmin)/mesh*(i-1)+tmin;
% % % 
% % % 
% % % 
% % %          Z(i) = vec(i);
% % % 
% % % 
% % %     end
% % %     mesh = 1000;
% % %     X1 = zeros([mesh 1]);
% % % Y = zeros([mesh 1]);
% % %  for i= 1:mesh
% % %         X1(i) = (tmax-tmin)/mesh*(i-1)+tmin;
% % % 
% % %          A = circulant(horzcat(zeros(1,1), ones(1,jump),zeros(1,dim-jump-1)));
% % %          A = A+A';
% % % 
% % % 
% % %         B= hitting_time_single_meas(A, initial, X1(i), N_tau,dim);
% % %         Y(i) = real(B(2));
% % % 
% % % 
% % % 
% % % 
% % %   end
% % % 
% % % 
% % % 
% % %    figure
% % %     plot(X1,Y,'m',LineWidth=2)
% % %     hold on 
% % %     plot(X,Z,'c*',MarkerSize=12)
% % % 
% % % a = xlabel(' $t$','interpreter','latex');
% % % b = ylabel('$\langle n \rangle$','interpreter','latex');
% % % 
% % % 
% % % a.FontSize= 35;
% % %  b.FontSize= 35;
% % % 
% % % 
% % %  set(gca, 'FontSize', 18);
% % % 
% % % 
% % % leg = legend({'Classical simulation', 'Qiskit simulation'} ,'interpreter','latex');
% % % leg.FontSize = 15;
% % % hold off;
% % 
% % 
% % 
% % 
% % % 
% % tmin = .5;
% % tmax = 1.5;
% % dim = 9;
% % jump = 3;
% % initial = 1;
% % N_tau = 200;
% % mesh = 21;
% % 
% % X = zeros([mesh 1]);
% % 
% % Z= zeros([mesh 1]);
% % 
% % 
% % vec = [5.016200000000001, 4.981719999999998, 5.009199999999998, 5.027379999999998, 5.017060000000002, 4.585120000000002, 4.96854, 4.013060000000001, 5.001299999999997, 5.009960000000001, 5.01992, 4.0084599999999995, 4.99, 5.015660000000002, 4.70346, 4.545939999999997, 4.986920000000002, 4.984719999999998, 4.996159999999999, 4.727,4];
% % for i= 1:mesh-1
% %         X(i) = (tmax-tmin)/(mesh-1)*(i-1)+tmin;
% % 
% % 
% % 
% %          Z(i) = vec(i);
% % 
% % 
% % end
% % X(21) = 1.472;
% % Z(21) = vec(21);
% %     mesh = 1000;
% %     X1 = zeros([mesh 1]);
% %     Y = zeros([mesh 1]);
% %     Y1 = zeros([mesh 1]);
% %     N_tau1 = 5000;
% %  for i= 1:mesh
% %         X1(i) = (tmax-tmin)/mesh*(i-1)+tmin;
% % 
% %          A = circulant(horzcat(zeros(1,1), ones(1,jump),zeros(1,dim-jump-1)));
% %          A = A+A';
% % 
% % 
% %         B= hitting_time_single_meas(A, initial, X1(i), N_tau,dim);
% %         Y(i) = real(B(2));
% %          B= hitting_time_single_meas(A, initial, X1(i), N_tau1,dim);
% %         Y1(i) = real(B(2));
% % 
% % 
% % 
% % 
% %   end
% % 
% % 
% % 
% %    figure
% %     plot(X1,Y,'m',LineWidth=2)
% %     hold on 
% %     plot(X1,Y1,'g',LineWidth=2)
% %     hold on 
% %     plot(X,Z,'c*', MarkerSize=12)
% % 
% % 
% %     a = xlabel(' $t$','interpreter','latex');
% % b = ylabel('$\langle n \rangle$','interpreter','latex');
% % 
% % 
% % a.FontSize= 35;
% %  b.FontSize= 35;
% % 
% % 
% %  set(gca, 'FontSize', 18);
% % 
% % 
% % leg = legend({'Classical simulation 200 run','Classical simulation 5000 run', 'Qiskit simulation'} ,'interpreter','latex');
% % leg.FontSize = 15;
% % hold off;
% % 
% % 
% % 
%     tmin = .5;
% tmax = 3;
% dim = 5;
% jump = 2;
% initial = dim;
% N_tau = 100;
% mesh = 100;
% 
% X = zeros([mesh 1]);
% 
% Z= zeros([mesh 1]);
% Z1= zeros([mesh 1]);
% 
% 
% vec1 = [0.2523000000000001, 0.24269999999999997, 0.25, 0.2573, 0.241, 0.25339999999999996, 0.24389999999999998, 0.25579999999999997, 0.24450000000000002, 0.2552999999999999, 0.24860000000000002, 0.2465, 0.25859999999999994, 0.2479, 0.2471, 0.2456, 0.24959999999999996, 0.24829999999999997, 0.2469, 0.2437, 0.24839999999999995, 0.2534999999999999, 0.2534999999999999, 0.2502, 0.25249999999999995, 0.2504, 0.24559999999999993, 0.2335000000000001, 0.18330000000000002, 0.07980000000000002, 0.0052000000000000015, 0.03470000000000002, 0.13629999999999998, 0.21420000000000003, 0.23860000000000012, 0.24519999999999995, 0.2501999999999999, 0.24959999999999993, 0.25109999999999993, 0.25139999999999996, 0.24699999999999994, 0.2531, 0.2455, 0.25139999999999996, 0.2482, 0.2583000000000001, 0.247, 0.24950000000000003, 0.24910000000000004, 0.2501, 0.24749999999999997, 0.25159999999999993, 0.24709999999999996, 0.24919999999999995, 0.2507, 0.24719999999999998, 0.2547, 0.2564, 0.2462, 0.2469, 0.2488, 0.25289999999999996, 0.25099999999999995, 0.2559, 0.24809999999999993, 0.25449999999999995, 0.2512, 0.24899999999999997, 0.25089999999999996, 0.2548999999999999, 0.24889999999999995, 0.24919999999999998, 0.24700000000000003, 0.2497, 0.25329999999999997, 0.25199999999999995, 0.24459999999999996, 0.2410000000000001, 0.2058999999999999, 0.11510000000000006, 0.016999999999999987, 0.013699999999999995, 0.10440000000000002, 0.19740000000000008, 0.22749999999999995, 0.2541999999999998, 0.2511999999999999, 0.2593999999999999, 0.24769999999999998, 0.25329999999999997, 0.24619999999999997, 0.24659999999999999, 0.2448, 0.2575, 0.25179999999999997, 0.25239999999999996, 0.24909999999999996, 0.25149999999999995, 0.24809999999999996, 0.2512999999999999];
% vec2 = [0.9996999999999995, 0.9999999999999997, 0.9999999999999993, 1.0, 0.9999999999999992, 0.9999999999999999, 0.9999999999999997, 0.9999999999999997, 0.9999999999999997, 0.9999999999999998, 0.9999999999999997, 0.9999999999999999, 0.9999999999999996, 1.0, 1.0000000000000002, 0.9999999999999999, 1.0000000000000002, 1.0, 0.9999999999999998, 0.9975999999999994, 0.8862999999999994, 0.6503999999999991, 0.9468999999999996, 0.9994999999999991, 0.9999999999999997, 0.9999999999999997, 0.9999999999999999, 0.9999999999999999, 0.9999999999999999, 1.0, 0.9999999999999999, 1.0, 1.0, 0.9999999999999997, 1.0, 0.9999999999999999, 0.9999999999999998, 1.0, 1.0, 1.0, 0.9999999999999999, 0.9999999999999999, 0.9999999999999994, 0.9988999999999995, 0.9650999999999993, 0.8353999999999999, 0.7201999999999997, 0.8434999999999994, 0.9732999999999997, 0.9986999999999988, 0.9997999999999999, 0.9999999999999992, 0.9999999999999998, 0.9999999999999997, 1.0, 0.9999999999999997, 0.9999999999999997, 0.9997999999999999, 0.9965999999999992, 0.9621999999999995, 0.8528999999999992, 0.6406999999999989, 0.5835999999999998, 0.7372999999999994, 0.9208999999999996, 0.9839999999999998, 0.9995999999999994, 1.0, 0.9999999999999996, 0.9999999999999998, 0.9999999999999999, 0.9999999999999998, 0.9999999999999999, 0.9999999999999999, 1.0, 0.9999999999999998, 1.0, 0.9999999999999999, 0.9999999999999993, 0.9999999999999996, 0.9999999999999999, 0.9997999999999997, 0.9962999999999999, 0.9693999999999993, 0.8634000000000003, 0.6417999999999998, 0.37209999999999993, 0.2835999999999999, 0.47290000000000026, 0.7382999999999996, 0.9172000000000001, 0.9834000000000002, 0.9981999999999993, 0.9997999999999998, 0.9998999999999997, 0.9999999999999997, 0.9999999999999998, 0.9999999999999999, 0.9999999999999999, 0.9999999999999998];
% for i= 1:mesh
%         X(i) = (tmax-tmin)/(mesh)*(i-1)+tmin;
%          Z(i) = vec1(i);
%          Z1(i) = vec2(i);
% end
% 
%     mesh = 1000;
%     X1 = zeros([mesh 1]);
%     Y = zeros([mesh 1]);
%     Y1 = zeros([mesh 1]);
%     T = zeros([mesh 1]);
%  for i= 1:mesh
%         X1(i) = (tmax-tmin)/mesh*(i-1)+tmin;
% 
%          A = circulant(horzcat(zeros(1,1), ones(1,jump),zeros(1,dim-jump-1)));
%          A = A+A';
% 
% 
%         B= hitting_time_single_meas(A, initial, X1(i), N_tau,dim);
%         Y(i) = real(B(1));
%          A = circulant(horzcat(zeros(1,1),exp(1i*pi/2)*ones(1,jump),zeros(1,dim-jump-1)));
%          A = A+A';
%         B= hitting_time_single_meas(A, initial, X1(i), N_tau,dim);
%         Y1(i) = real(B(1));
%         T(i) = 1/4;
% 
% 
% 
%   end
% 
% 
% 
%    figure
%     plot(X1,Y,'m',LineWidth=2)
%     hold on 
%     plot(X1,Y1,'r',LineWidth=2)
%     hold on
%     plot(X,Z,'c*',MarkerSize=12)
%     hold on
%     plot(X,Z1, 'g*',MarkerSize=12)
%     hold on
%     plot(X1,T,'k--',LineWidth=2)
% 
% 
%  a = xlabel(' $t$','interpreter','latex');
% b = ylabel('Detection Probability','interpreter','latex');
% axis([0.5 3 0 1.2])
% 
% a.FontSize= 35;
%  b.FontSize= 35;
% 
% 
%  set(gca, 'FontSize', 18);
% 
% 
% leg = legend({'Classical $\alpha = 0$', 'Classical $\alpha = \pi/2$','Qiskit $\alpha = 0$', 'Qiskit $\alpha = \pi/2$', 'Symmetry threshold = $\frac{1}{4}$'} ,'interpreter','latex');
% leg.FontSize = 15;
% hold off;
% 
% % 
% % 
% % 
% % 
% % % tmin = 0.525;
% % % tmax = 3;
% % % dim = 6;
% % % jump = 1;
% % % initial = dim;
% % % N_tau = 100;
% % % mesh = 100;
% % % 
% % % X = zeros([mesh 1]);
% % % 
% % % Z= zeros([mesh 1]);
% % % 
% % % Z1= zeros([mesh 1]);
% % % vec1 = [1.0000000000000002, 1.0000000000000002, 0.9999999999999999, 1.0, 0.9999999999999998, 1.0000000000000002, 0.9999999999999999, 0.9999999999999998, 0.9999999999999999, 1.0, 0.9999999999999998, 0.9999999999999999, 0.9999999999999999, 0.9999999999999998, 1.0, 0.9999999999999998, 1.0000000000000002, 0.9999999999999999, 0.9999999999999999, 1.0, 0.9999999999999999, 0.9999999999999999, 0.9999999999999998, 0.9999999999999998, 0.9999999999999998, 0.9999999999999999, 0.9999999999999999, 0.9999999999999999, 1.0000000000000002, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 0.9999999999999998, 0.9999999999999999, 1.0000000000000002, 0.9999999999999999, 1.0, 0.9999999999999999, 0.9999999999999998, 0.9999999999999999, 0.9999999999999998, 1.0000000000000002, 1.0, 1.0, 0.9999999999999998, 1.0, 0.9999999999999999, 1.0, 1.0, 0.9999999999999998, 1.0, 1.0, 0.9999999999999999, 1.0, 0.9999999999999998, 1.0, 0.9999999999999998, 0.9999999999999999, 0.9929999999999991, 0.8059, 0.16, 0.22,0.8305, 1.0000000000000004, 0.9999999999999999, 0.9999999999999999, 0.9999999999999994, 1.0000000000000002, 1.0, 0.9999999999999999, 0.9999999999999997, 0.9999999999999998, 1.0000000000000002, 0.9999999999999998, 0.9999999999999998, 0.9999999999999999, 1.0, 0.9999999999999998, 0.9999999999999999, 1.0000000000000002, 0.9999999999999999, 0.9999999999999998, 1.0000000000000002, 0.9999999999999999, 1.0, 1.0000000000000002, 0.9999999999999999, 0.9999999999999999, 0.9999999999999999, 0.9999999999999999, 0.9999999999999999, 0.9999999999999999, 0.9999999999999998, 1.0, 1.0, 0.9999999999999999, 0.9999999999999998];
% % % vec2 = [9.180399999999999, 5.035399999999999, 8.727799999999997, 7.591199999999998, 5.505100000000001, 9.602899999999998, 11.2468, 4.591899999999999, 4.3674, 4.4117, 3.5949000000000004, 7.0876, 7.48, 5.014299999999999, 4.440699999999999, 9.355999999999998, 7.3218, 3.2063000000000006, 3.9116999999999997, 8.652800000000001, 4.698099999999998, 6.3192, 2.7124, 3.602499999999999, 2.5441000000000007, 5.713399999999999, 8.935300000000002, 7.488900000000001, 2.0751, 9.6554, 4.2318, 1.9844999999999997, 6.592999999999999, 3.7819, 3.6794, 6.074400000000001, 5.8348, 3.6992000000000003, 1.8701999999999999, 9.121799999999999, 2.2086, 2.0456999999999996, 3.2272999999999996, 2.2297, 4.779699999999999, 5.8702000000000005, 3.6320000000000006, 4.9977, 3.1537, 9.092299999999996, 5.003100000000001, 6.2312, 4.6930000000000005, 5.455700000000001, 4.206199999999999, 5.398199999999999, 5.6513, 6.6234, 8.357, 13.4091, 14.755, 27.25040000000001, 27.2851, 6.0983, 32.69480000000001, 19.778999999999996, 13.379500000000002, 9.752600000000001, 6.479699999999999, 6.317499999999998, 6.2692, 4.0382, 3.8756, 5.511799999999999, 9.107500000000002, 7.0277, 9.021299999999998, 2.7044999999999995, 5.065799999999999, 3.3468999999999998, 4.826400000000001, 7.587500000000001, 3.639, 5.5155, 3.642, 2.1513000000000004, 3.9002000000000008, 8.556899999999999, 8.7538, 10.092900000000002, 3.747300000000001, 7.687899999999999, 11.604600000000001, 6.305000000000001, 6.990200000000001, 8.857, 3.8830000000000005, 7.538, 5.5179, 10.072299999999998];
% % % 
% % % for i= 1:mesh
% % %         X(i) = (tmax-tmin)/(mesh)*(i-1)+tmin;
% % %          Z(i) = vec1(i);
% % %          Z1(i) = vec2(i);
% % % 
% % % end
% % % 
% % %     mesh = 1000;
% % %     X1 = zeros([mesh 1]);
% % %     Y = zeros([mesh 1]);
% % %     Y1 = zeros([mesh 1]);
% % %     Y2 = zeros([mesh 1]);
% % %  for i= 1:mesh
% % %         X1(i) = (tmax-tmin)/mesh*(i-1)+tmin;
% % % 
% % %          A = circulant(horzcat(zeros(1,1), ones(1,jump),zeros(1,dim-jump-1)));
% % %          A = A+A';
% % % 
% % % 
% % %         B= hitting_time_single_meas(A, initial, X1(i), N_tau,dim);
% % %         Y2(i) = real(B(1));
% % % 
% % %         B= hitting_time_rand_meas(A, initial, X1(i), N_tau,dim);
% % %         Y1(i) = real(B(1));
% % %         Y(i) = real(B(2));
% % % 
% % % 
% % % 
% % % 
% % % 
% % %   end
% % % 
% % % mesh = 100;
% % % 
% % %    figure
% % %     plot(X1,Y,'m',LineWidth=2)
% % %     hold on
% % %     plot(X+0.025*ones([mesh 1]),Z1,'c*', MarkerSize=12)
% % %    axis([0.525 3 0 inf])
% % % 
% % % 
% % %      a = xlabel(' $t$','interpreter','latex');
% % % b = ylabel('$\langle n \rangle$','interpreter','latex');
% % % 
% % % 
% % % a.FontSize= 35;
% % %  b.FontSize= 35;
% % % 
% % % 
% % %  set(gca, 'FontSize', 18);
% % % 
% % % 
% % % leg = legend({'Classical random site', 'Qiskit random site'} ,'interpreter','latex');
% % % leg.FontSize = 15;
% % % hold off;
% % % 
% % %  figure 
% % %     plot(X1,Y1,'m',LineWidth=2)
% % %     hold on
% % %     plot(X,Z,'c*',MarkerSize=12)
% % %         hold on
% % % 
% % %     plot(X1,Y2,'g--',LineWidth=2)
% % % 
% % %          a = xlabel(' $t$','interpreter','latex');
% % % b = ylabel('Detection Probability','interpreter','latex');
% % % 
% % % 
% % % a.FontSize= 35;
% % %  b.FontSize= 35;
% % % 
% % % 
% % %  set(gca, 'FontSize', 18);
% % % 
% % % 
% % % leg = legend({'Classical random site', 'Qiskit random site','Classical single site'} ,'interpreter','latex');
% % % leg.FontSize = 15;
% % 
% % 
% % 
% % 
% % 
% % 
% % 
tmin = 0.5;
tmax = 3;
dim = 13;
jump = 1;
initial = dim;
N_tau = 5000;
A = circulant(horzcat(zeros(1,1), ones(1,jump),zeros(1,dim-jump-1)));
         A = A+A';

       mesh = 1000;
    X1 = zeros([mesh 1]);

    Y1 = zeros([mesh 1]);
    Y2 = zeros([mesh 1]);
 for i= 1:mesh
        X1(i) = (tmax-tmin)/mesh*(i-1)+tmin;




        B= hitting_time_single_meas(A, initial, X1(i), N_tau,dim);
        Y2(i) = real(B(1));

        B= hitting_time_alternate_meas(A, initial, X1(i), N_tau,dim);
        Y1(i) = real(B(1));

 end

     figure 
    % plot(X1,Y1,'m',LineWidth=2)
    % hold on


    plot(X1,Y2,'g',LineWidth=2)

     a = xlabel(' $t$','interpreter','latex');
b = ylabel('Detection Probability','interpreter','latex');
axis([0.5 3 0 1])

a.FontSize= 35;
 b.FontSize= 35;


 set(gca, 'FontSize', 18);


% leg = legend({'Alternate site', 'Single site'} ,'interpreter','latex');
% leg.FontSize = 15;

% % 
% % 
% % % finalyx = [0,pi/6, pi/4, pi/3,pi/2,2*pi/3];
% % % 
% % % 
% % %  finaly1 = [ 12279.4457202928,
% % % 13462.3250034311,
% % % 16810.5359393887,
% % % 18441.5618107818,
% % % 6584.70183020109,
% % % 18441.5618107824];
% % %  vec1 = [12269.313469326954, 13476.7412946491649, 16412.6149691641, 18723.4398151056085, 6583.91469769, 18647.7283575027502];
% % %    finaly2 = [9507.16505078498,
% % % 10501.4201182701,
% % % 14241.4822954001,
% % % 15132.5403114047,
% % % 5014.99053167105,
% % % 15056.0838714336];
% % %     vec2 = [9468.7241707478432874,10367.73402784301284, 14490.7239872740, 15208.91380902985,4789.329293294794,15123.94820480];
% % %        figure
% % %     plot(finalyx,finaly1,'m',LineWidth=2)
% % %     hold on
% % %     plot(finalyx,vec1,'c*','MarkerSize', 12)
% % %     hold on 
% % %     plot(finalyx,finaly2,'g',LineWidth=2)
% % %     hold on
% % %     plot(finalyx,vec2,'r*','MarkerSize', 12)
% % % 
% % %  a = xlabel(' $\alpha$','interpreter','latex');
% % % b = ylabel('Integral of $\langle n \rangle $','interpreter','latex');
% % % 
% % % 
% % % a.FontSize= 35;
% % %  b.FontSize= 35;
% % % 
% % % 
% % %  set(gca, 'FontSize', 18);
% % % 
% % % 
% % % leg = legend({'Classical double site', 'Qiskit double site','Classical random site','Classical random site'} ,'interpreter','latex');
% % % leg.FontSize = 15;
% % % 